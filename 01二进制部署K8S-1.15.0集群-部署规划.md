[toc]

## 1. 二进制部署K8S-1.15.0集群-部署规划

### 1.1 etcd集群规划

|      IP       |  组件  |  备注  |
| :-----------: | :----: | :----: |
| 192.168.1.221 | etcd01 | 3.3.13 |
| 192.168.1.222 | etcd02 | 3.3.13 |
| 192.168.1.223 | etcd03 | 3.3.13 |

### 1.2 master节点规划

|      IP       |                         组件                          |  备注  |
| :-----------: | :---------------------------------------------------: | :----: |
| 192.168.1.221 | kube-apiserver,kube-scheduler,kube-controller-manager | 1.15.0 |
| 192.168.1.222 | kube-apiserver,kube-scheduler,kube-controller-manager | 1.15.0 |
| 192.168.1.223 | kube-apiserver,kube-scheduler,kube-controller-manager | 1.15.0 |

### 1.3 master和apiserver的vip规划

|      IP       |      VIP      |                   组件                   | 备注 |
| :-----------: | :-----------: | :--------------------------------------: | :--: |
| 192.168.1.216 | 192.168.1.217 | haproxy+keepalived,kubelet,ingress-nginx | LB01 |
| 192.168.1.218 | 192.168.1.219 | haproxy+keepalived,kubelet,ingress-nginx | LB02 |

### 1.4 LB节点规划(也用作ingress节点)

用于引入外部流量

|      IP       |      VIP      | 组件 | 备注 |
| :-----------: | :-----------: | :--: | :--: |
| 192.168.1.216 | 192.168.1.217 |      | LB01 |
| 192.168.1.218 | 192.168.1.219 |      | LB02 |

### 1.5 NODE节点规划

|      IP       |   组件   | 备注  |
| :-----------: | :------: | :---: |
| 192.168.1.224 | node组件 | node1 |
| 192.168.1.225 | node组件 | node2 |

### 1.6 ingress节点规划

没有机器了，使用LB节点做ingress节点吧

### 1.7 镜像仓库规划

|      IP       |  组件  | 备注 |
| :-----------: | :----: | :--: |
| 192.168.1.229 | harbor |      |

由于机器不够，未对镜像仓库做高可用，实际还是需要的做高用的，使用统一后端存储来实现高可用。

### 1.8 存储集群规划

|      IP       | 组件 |                 备注                 |
| :-----------: | :--: | :----------------------------------: |
| 192.168.1.222 | nfs  | 没有机器了，拿master02做nfs-server吧 |

### 1.9 控制节点

|      IP       |  组件   | 备注 |
| :-----------: | :-----: | ---- |
| 192.168.1.210 | kubectl |      |

### 1.10 网络环境规划

|  网络类型   |      IP段      | 备注 |
| :---------: | :------------: | :--: |
| 各节点网络  | 192.168.1.0/24 |      |
|  容器网络   |  10.48.0.0/12  |      |
| Service网络 |  10.64.0.0/16  |      |
| K8S集群DNS  |   10.64.0.2    |      |
|  DNS搜索域  |  dukang.local  |      |